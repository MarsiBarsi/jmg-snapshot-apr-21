<ng-container *ngIf="notes$ | async as notes" class="piano">
    <ng-container *ngForMap="let note of notes; let d = destroyed">
        <ng-container waAudioBufferSourceNode autoplay [buffer]="toBuffer(note)">
            <ng-container
                waGainNode
                gain="0"
                [gain]="volume(note, notes, d) | adsr: 0:0.1:volume(note, notes, d):0.01"
            >
                <ng-container waAudioDestinationNode></ng-container>
                <ng-container waGainNode gain="0.3">
                    <ng-container [waOutput]="convolver"></ng-container>
                </ng-container>
            </ng-container>
        </ng-container>
    </ng-container>
    <ng-container
        #convolver="AudioNode"
        waConvolverNode
        buffer="assets/audio/piano/response.aac"
    >
        <ng-container waAudioDestinationNode></ng-container>
    </ng-container>
</ng-container>
